---
title: 介紹
sidebar_label: 介紹
keywords: ["Message Queue"]
description: 認識訊息佇列
sidebar_position: 0
tags: ["Message Queue"]
---

## 什麼是訊息佇列

訊息佇列使應用程式間可以通過發送和接收訊息來做交互，而不需要直接顯式呼叫。

### 效益

- 解耦：通過引入訊息佇列，發送者和接收者不必同時在線，從而實現應用程序之間的解耦。
- 容錯：當訊息消費發生故障時，訊息可以暫存在佇列中，等待消費者恢復後再處理。
- 異步處理：可以將需要耗時的操作異步化，從而提高系統的響應速度和吞吐量。
- 事件驅動：推播/訂閱模式 是事件驅動架構的基礎。系統可以根據事件進行反應，實現更加靈活和高效的業務流程。
- 降低峰值壓力：在高併發場景下，可以通過訊息佇列作為請求緩衝，減少系統的瞬時壓力。

訊息佇列可以做為傳統服務彼此間直接呼叫的中介層，透過這個中介層，可以讓原本會遇到的問題，例如瞬時大流量，或是錯誤處理，都可以透過這個中介層 (訊息佇列) 處理。


## Scenario

1. 訂單處理系統  
在電子商務平台上，用戶送出訂單後，訂單訊息會通過 MQ 進行處理。這樣可以確保訂單處理過程中的各個環節 (如支付、庫存更新、物流) 能夠非同步執行，並處理高並發的訂單請求。

2. 日誌收集與分析  
分佈式系統中的各個服務產生的大量日誌數據可以通過 MQ 進行收集，然後統一傳送到日誌分析系統 (如 ELK 堆棧：Elasticsearch, Logstash, Kibana)。這樣可以提高日誌處理的效率，實現實時監控和分析。

3. 數據同步  
在微服務架構中，各個服務之間需要保持數據一致性。MQ 可以用來進行數據同步，確保不同服務之間的數據狀態一致。例如，用戶數據變更後，相關的服務可以通過 MQ 接收到變更通知並更新自己的數據。

4. 異步任務處理
某些耗時的操作 (Ex: 轉檔、圖片處理) 可以通過 MQ 進行異步處理。用戶提交任務後，立即返回響應，而具體的處理則由後端異步完成，完成後再主動通知用戶，這樣可以提高系統的響應速度和用戶體驗。

5. 即時推播
社交媒體、遊戲、新聞等應用需要向用戶即時推播消息。通過 MQ，可以實現高效的消息分發和推送，確保消息能夠及時送達用戶。

7. 負載平衡
MQ 可以用來實現系統的負載平衡。當前端請求量過大時，可以通過 MQ 將請求分發到多個後端服務進行處理，從而平衡負載，防止單一服務負載過高。

8. 容錯與恢復
MQ 提供的傳遞機制可以用來實現系統的容錯與恢復。當某個服務出現故障時，消息仍然會保留在隊列中，待服務恢復後再進行處理，確保不會丟失重要數據。

9. 事件驅動架構
在事件驅動架構中，各個服務通過事件進行通信和協作。MQ 是事件驅動架構的核心組件，可以實現事件的發布和訂閱，確保各個服務能夠即時響應事件。

## 主流框架

### RabbitMQ

| 特點             | 說明                                 |
| ---------------- | ------------------------------------ |
| 開發語言         | Erlang                               |
| 協議             | AMQP, MQTT, STOMP                    |
| Language Support | 非常好。大部分的主流開發語言都有支援 |
|                  |                                      |

：
協議支持：AMQP、MQTT、STOMP
特點：
易於使用，文檔豐富。
高可靠性和穩定性。
支持多種交換器類型，靈活的路由機制。
提供強大的管理和監控工具。
應用場景：企業級應用，金融行業，電商系統，實時消息推送。
2. Apache Kafka
開發語言：Scala、Java
協議支持：Kafka協議
特點：
高吞吐量，適合處理大量的流數據。
支持分區和複製，提高可用性和容錯性。
提供消息持久化和日誌保存功能。
強大的流處理能力，適合實時數據處理和分析。
應用場景：日誌收集、實時數據流處理、事件流處理、大數據應用。
3. ActiveMQ
開發語言：Java
協議支持：JMS、AMQP、MQTT、STOMP
特點：
支持多種協議，靈活性高。
提供持久性消息和高可用性支持。
具有豐富的企業集成功能（如事務管理、消息篩選）。
社區活躍，文檔全面。
應用場景：企業應用集成、Java應用的消息中間件。
4. RocketMQ
開發語言：Java
協議支持：RocketMQ協議
特點：
高性能和低延遲，支持大規模併發。
支持事務消息和順序消息。
提供高可用性和分佈式事務支持。
社區活躍，阿里巴巴主導開發，應用廣泛。
應用場景：金融交易系統，電商訂單處理，實時消息處理。

